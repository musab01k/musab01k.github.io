---
import Header from "../components/Header.astro";
import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import Projects from "../components/Projects.astro";
import Experience from "../components/Experience.astro";
import Education from "../components/Education.astro";
import Footer from "../components/Footer.astro";
import { siteConfig } from "../config";
import "../styles/global.css";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <meta name="description" content={siteConfig.description} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <title>{siteConfig.name} - {siteConfig.title}</title>
  </head>
  <body>
    <Header />
    <section>
      <Hero />
      <About />
      <Projects />
      <Experience />
      <Education />
    </section>
    <Footer />
    
    <!-- Mobile language toggle button (floating, bottom right) -->
    <button
      id="language-toggle-mobile"
      class="fixed bottom-6 right-6 md:hidden z-50 bg-white shadow-lg rounded-full px-4 py-3 flex items-center gap-2 text-gray-700 hover:text-black transition-all duration-300 hover:shadow-xl border border-gray-200"
      aria-label="Change language"
    >
      <span id="language-flag-mobile">ðŸ‡«ðŸ‡·</span>
      <span id="language-display-mobile" class="font-bold">FR</span>
    </button>
    
    <script is:inline>
      // Content translation system
      const contentData = {
        fr: {
          title: "Etudiant en derniÃ¨re annÃ©e de Master Informatique axÃ©e sur l'IA et la Data Science",
          aboutMe: "Ã‰tudiant en derniÃ¨re annÃ©e d'informatique, je cherche un stage de fin d'Ã©tudes en IA ou data science afin d'appliquer mes compÃ©tences en apprentissage automatique et analyse de donnÃ©es Ã  des projets concrets. Je suis interessÃ© par l'aÃ©ronautique, l'avionique, l'espace, l'intelligence artificielle, et l'energie.",
          sections: { about: 'Ã€ propos de moi', projects: 'Projets', experience: 'ExpÃ©rience', education: 'Ã‰ducation' },
          projects: [
            { name: "Agent conversationnel LLM intÃ©grÃ© Ã  une carte interactive (AgentMap)", description: "Traitement de donnÃ©es gÃ©ospatiales (Pandas) et classification automatique des requÃªtes.\nâ€” Conversion des demandes en SQL via LLM et interrogation de la base par API.\nâ€” Visualisation des rÃ©sultats sur des cartes interactives." },
            { name: "Classification du cancer du sein Ã  partir de scans mÃ©dicaux ", description: "Conception d'un rÃ©seau de neurones (CNN) pour analyser les images et dÃ©terminer la prÃ©sence de cancer.\nâ‡’ ModÃ¨le permettant de trier les scans pour mettre en avant les cas Ã  risque et allÃ©ger la charge aux mÃ©decins." },
            { name: "Cand Auto (projet personnel)", description: "Conception d'un script d'envoi automatique de candidatures, intÃ©grant l'API\nOpenAI pour la gÃ©nÃ©ration dynamique de mails et lettres de motivation personnalisÃ©s, envoyÃ©s automatiquement vers\nun dataset d'adresses e-mail collectÃ©es." },
            { name: "Battery Life Span", description: "Conception de plusieurs modÃ¨les de machine learning qui permettent de\n         prÃ©dire la durÃ©e de vie d'une batterie en fonction de ses caractÃ©ristiques." }
          ],
          experience: [
            {
              title: "Stagiaire",
              company: "Stage Ã  l'Ã©tranger, Turkish Aerospace Industries (TUSAS)",
              bullets: [
                "Participation Ã  l'analyse et Ã  l'exploitation des donnÃ©es provenant des systÃ¨mes internes",
                "Identifier les tendances significatives, les corrÃ©lations entre diverses variables et les prÃ©senter de maniÃ¨re efficace",
                "PrÃ©parer des rapports techniques et des recommandations exploitables basÃ©es sur ses analyses",
                "Contribuer au dÃ©veloppement d'un tableau de bord interactif pour la visualisation et l'analyse des donnÃ©es"
              ]
            }
          ],
          education: [
            { degree: "Master Sciences de donnÃ©es et systÃ¨mes complexes", school: "UniversitÃ© de Strasbourg" },
            { degree: "Licence d'informatique", school: "UniversitÃ© de Strasbourg" }
          ]
        },
        en: {
          title: "Final year Master's student in Computer Science focused on AI and Data Science",
          aboutMe: "Final year computer science student, seeking an end-of-studies internship in AI or data science to apply my skills in machine learning and data analysis to concrete projects. I am interested in aeronautics, avionics, space, artificial intelligence, and energy.",
          sections: { about: 'About Me', projects: 'Projects', experience: 'Experience', education: 'Education' },
          projects: [
            { name: "LLM conversational agent integrated into an interactive map (AgentMap)", description: "Geospatial data processing (Pandas) and automatic query classification.\nâ€” Converting requests to SQL via LLM and querying the database via API.\nâ€” Visualizing results on interactive maps." },
            { name: "Breast cancer classification from medical scans", description: "Design of a neural network (CNN) to analyze images and determine the presence of cancer.\nâ‡’ Model that sorts scans to highlight at-risk cases and reduce the workload for doctors." },
            { name: "Cand Auto (personal project)", description: "Design of an automatic job application sending script, integrating the\nOpenAI API for dynamic generation of personalized emails and cover letters, automatically sent to\na dataset of collected email addresses." },
            { name: "Battery Life Span", description: "Design of several machine learning models that allow\n         predicting battery lifespan based on its characteristics." }
          ],
          experience: [
            {
              title: "Intern",
              company: "Internship abroad, Turkish Aerospace Industries (TUSAS)",
              bullets: [
                "Participated in the analysis and exploitation of data from internal systems",
                "Identified significant trends, correlations between various variables and presented them effectively",
                "Prepared technical reports and actionable recommendations based on analyses",
                "Contributed to the development of an interactive dashboard for data visualization and analysis"
              ]
            }
          ],
          education: [
            { degree: "Master's in Data Science and Complex Systems", school: "University of Strasbourg" },
            { degree: "Bachelor's in Computer Science", school: "University of Strasbourg" }
          ]
        }
      };
      
      function updateContent(lang) {
        const content = contentData[lang];
        if (!content) return;
        
        // Update title (update all elements with this attribute)
        document.querySelectorAll('[data-content="title"]').forEach((el) => {
          el.textContent = content.title;
        });
        
        // Update aboutMe
        const aboutEl = document.querySelector('[data-content="aboutMe"]');
        if (aboutEl) aboutEl.textContent = content.aboutMe;
        
        // Update section titles
        const sectionAbout = document.querySelector('[data-content="section.about"]');
        if (sectionAbout) sectionAbout.textContent = content.sections.about;
        
        const sectionProjects = document.querySelector('[data-content="section.projects"]');
        if (sectionProjects) sectionProjects.textContent = content.sections.projects;
        
        const sectionExperience = document.querySelector('[data-content="section.experience"]');
        if (sectionExperience) sectionExperience.textContent = content.sections.experience;
        
        const sectionEducation = document.querySelector('[data-content="section.education"]');
        if (sectionEducation) sectionEducation.textContent = content.sections.education;
        
        // Update projects
        for (let i = 0; i < content.projects.length; i++) {
          const nameEl = document.querySelector(`[data-content="project.name.${i}"]`);
          if (nameEl && content.projects[i]) nameEl.textContent = content.projects[i].name;
          
          const descEl = document.querySelector(`[data-content="project.description.${i}"]`);
          if (descEl && content.projects[i]) descEl.textContent = content.projects[i].description;
        }
        
        // Update experience
        for (let i = 0; i < content.experience.length; i++) {
          const titleEl = document.querySelector(`[data-content="exp.title.${i}"]`);
          if (titleEl && content.experience[i]) titleEl.textContent = content.experience[i].title;
          
          const companyEl = document.querySelector(`[data-content="exp.company.${i}"]`);
          if (companyEl && content.experience[i]) companyEl.textContent = content.experience[i].company;
          
          // Update bullets
          content.experience[i].bullets.forEach((bullet, bulletIndex) => {
            const bulletEl = document.querySelector(`[data-content="exp.bullet.${i}.${bulletIndex}"]`);
            if (bulletEl) bulletEl.textContent = bullet;
          });
        }
        
        // Update education
        for (let i = 0; i < content.education.length; i++) {
          const degreeEl = document.querySelector(`[data-content="edu.degree.${i}"]`);
          if (degreeEl && content.education[i]) degreeEl.textContent = content.education[i].degree;
          
          const schoolEl = document.querySelector(`[data-content="edu.school.${i}"]`);
          if (schoolEl && content.education[i]) schoolEl.textContent = content.education[i].school;
        }
      }
      
      // Listen for content updates from Header script
      window.addEventListener('contentupdate', (e) => {
        updateContent(e.detail.lang);
      });
      
      // Mobile language toggle button handler
      const mobileLangToggle = document.getElementById('language-toggle-mobile');
      if (mobileLangToggle) {
        mobileLangToggle.addEventListener('click', () => {
          const storedLang = localStorage.getItem('portfolio-language');
          const currentLang = (storedLang === 'fr' || storedLang === 'en') ? storedLang : 'en';
          const newLang = currentLang === 'fr' ? 'en' : 'fr';
          
          // Update localStorage
          localStorage.setItem('portfolio-language', newLang);
          document.documentElement.lang = newLang;
          
          // Trigger language change event (Header script will handle it)
          window.dispatchEvent(new CustomEvent('languagechange', { detail: { lang: newLang } }));
          window.dispatchEvent(new CustomEvent('contentupdate', { detail: { lang: newLang } }));
        });
      }
      
      // Sync mobile button with language changes
      function updateMobileButton(lang) {
        const langDisplay = document.getElementById('language-display-mobile');
        const langFlag = document.getElementById('language-flag-mobile');
        const targetLang = lang === 'fr' ? 'en' : 'fr';
        if (langDisplay) langDisplay.textContent = targetLang.toUpperCase();
        if (langFlag) langFlag.textContent = targetLang === 'fr' ? 'ðŸ‡«ðŸ‡·' : 'ðŸ‡¬ðŸ‡§';
      }
      
      // Listen for language changes to sync mobile button
      window.addEventListener('languagechange', (e) => {
        updateMobileButton(e.detail.lang);
      });
      
      // Initialize mobile button
      const storedLang = localStorage.getItem('portfolio-language');
      const initialLang = (storedLang === 'fr' || storedLang === 'en') ? storedLang : 'en';
      updateMobileButton(initialLang);
      
      // No initial update needed here - Header script handles it
    </script>
  </body>
</html>
